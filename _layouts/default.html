<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ site.title }}</title>
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        /* ... (previous styles remain the same) ... */
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-links">
                {% for link in site.nav_links %}
                    <a href="{{ link.url }}">{{ link.name }}</a>
                {% endfor %}
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="social-links">
                {% if site.social_links.twitter %}
                    <a href="{{ site.social_links.twitter }}"><i data-feather="twitter"></i></a>
                {% endif %}
                {% if site.social_links.linkedin %}
                    <a href="{{ site.social_links.linkedin }}"><i data-feather="linkedin"></i></a>
                {% endif %}
                {% if site.social_links.github %}
                    <a href="{{ site.social_links.github }}"><i data-feather="github"></i></a>
                {% endif %}
                {% if site.social_links.email %}
                    <a href="{{ site.social_links.email }}"><i data-feather="mail"></i></a>
                {% endif %}
            </div>
        </nav>
    </header>

    <section class="profile">
        <img src="{{ site.profile_image }}" alt="{{ site.title }}">
        <div class="profile-info">
            <h1>{{ site.title }} <span class="pronunciation">({{ site.pronunciation }})</span></h1>
            <p>{{ site.position }}</p>
            <p>{{ site.affiliation }}</p>
            <div class="previous">Previously</div>
            <p>{{ site.previous_position }}</p>
            <p>{{ site.thesis_link }}</p>
        </div>
    </section>

    <section id="about" class="section">
        <h2>{{ site.intro_title }}</h2>
        <div class="intro-container">
            <div class="intro-content">
                {{ site.intro | markdownify }}
            </div>
            {% if site.intro_video %}
            <div class="intro-video">
                <div class="video-container">
                    <div class="video-thumbnail" style="background-image: url('https://img.youtube.com/vi/{{ site.intro_video }}/0.jpg');">
                        <div class="video-play-button"></div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </section>

    <section id="publications" class="section">
        <h2>
            Research & Publications
            <a href="{{ site.google_scholar }}" class="google-scholar">
                <i data-feather="external-link" style="height: 18px;"></i> Google scholar link
            </a>
        </h2>
        <div class="tags">
            {% for tag in site.publication_tags %}
                <span class="tag" data-tag="{{ tag }}">{{ tag }}</span>
            {% endfor %}
        </div>
        <div class="publications">
            {% for pub in site.publications %}
                <div class="publication" data-tags="{{ pub.tags | join: ',' }}">
                    <img src="{{ pub.image }}" alt="{{ pub.title }}">
                    <div class="publication-content">
                        <h3>{{ forloop.index }}. {{ pub.title }}</h3>
                        <p class="description">
                            {{ pub.description | truncatewords: 50, "..." }}
                            {% if pub.description.size > 350 %}
                                <span class="read-more">Read more</span>
                            {% endif %}
                        </p>
                        <p class="full-description" style="display: none;">
                            {{ pub.description }}
                        </p>
                        <div class="publication-links">
                            {% if pub.paper %}<a href="{{ pub.paper }}"><i data-feather="file-text" class="icon"></i> Paper</a>{% endif %}
                            {% if pub.video %}<a href="{{ pub.video }}"><i data-feather="video" class="icon"></i> Video</a>{% endif %}
                            {% if pub.project %}<a href="{{ pub.project }}"><i data-feather="code" class="icon"></i> Project</a>{% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </section>

    <script>
        feather.replace();

        const tags = document.querySelectorAll('.tag');
        const publications = document.querySelectorAll('.publication');

        tags.forEach(tag => {
            tag.addEventListener('click', () => {
                tag.classList.toggle('active');
                filterPublications();
            });
        });

        function filterPublications() {
            const activeTags = Array.from(tags).filter(tag => tag.classList.contains('active')).map(tag => tag.dataset.tag);

            publications.forEach(pub => {
                const pubTags = pub.dataset.tags.split(',');
                if (activeTags.length === 0 || activeTags.some(tag => pubTags.includes(tag))) {
                    pub.style.display = '';
                } else {
                    pub.style.display = 'none';
                }
            });
        }

        // Video functionality
        const videoContainer = document.querySelector('.video-container');
        const videoThumbnail = document.querySelector('.video-thumbnail');
        const playButton = document.querySelector('.video-play-button');

        if (videoThumbnail && playButton) {
            videoThumbnail.addEventListener('click', loadVideo);
            playButton.addEventListener('click', loadVideo);
        }

        function loadVideo(e) {
            e.stopPropagation();
            const videoId = '{{ site.intro_video }}';
            const iframe = document.createElement('iframe');
            iframe.setAttribute('allowfullscreen', '');
            iframe.setAttribute('allow', 'autoplay');
            iframe.setAttribute('src', `https://www.youtube.com/embed/${videoId}?rel=0&showinfo=0&autoplay=1`);
            iframe.style.position = 'absolute';
            iframe.style.top = '0';
            iframe.style.left = '0';
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            videoContainer.innerHTML = '';
            videoContainer.appendChild(iframe);
        }

        // Hamburger menu functionality
        const hamburger = document.querySelector('.hamburger');
        const navLinks = document.querySelector('.nav-links');

        hamburger.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });

        // Read More functionality
        document.querySelectorAll('.read-more').forEach(button => {
            button.addEventListener('click', function() {
                const descriptionElement = this.closest('.publication-content').querySelector('.description');
                const fullDescriptionElement = this.closest('.publication-content').querySelector('.full-description');
                
                if (this.textContent === 'Read more') {
                    descriptionElement.style.display = 'none';
                    fullDescriptionElement.style.display = 'block';
                    this.textContent = 'Read less';
                } else {
                    descriptionElement.style.display = 'block';
                    fullDescriptionElement.style.display = 'none';
                    this.textContent = 'Read more';
                }
            });
        });
    </script>
</body>
</html>